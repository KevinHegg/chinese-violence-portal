---
import PageLayout from "../layouts/PageLayout.astro";
import { fetchArticlesData } from "../utils/googleSheets";

export const prerender = false;

// Fetch articles from Google Sheets
const articles = await fetchArticlesData();

// Normalize citation to remove duplicate quotes that might come from CSV parsing
const normalizeCitation = (citation: string): string => {
  if (!citation) return "";
  let normalized = citation.trim();

  const straightQuote = '"';
  const smartOpenQuote = '“';
  const smartCloseQuote = '”';

  // Handle pattern: "“Title"” -> “Title”
  if (
    normalized.length >= 4 &&
    normalized.startsWith(straightQuote) &&
    normalized[1] === smartOpenQuote &&
    normalized.endsWith(straightQuote) &&
    normalized[normalized.length - 2] === smartCloseQuote
  ) {
    normalized = normalized.slice(1, -1);
  }

  // Strip smart quotes entirely (not present in spreadsheet)
  if (normalized.includes(smartOpenQuote) || normalized.includes(smartCloseQuote)) {
    normalized = normalized.split(smartOpenQuote).join('');
    normalized = normalized.split(smartCloseQuote).join('');
  }

  // Handle pattern: ""Title"" -> "Title" (double straight quotes wrapped)
  if (
    normalized.length >= 4 &&
    normalized.startsWith(straightQuote + straightQuote) &&
    normalized.endsWith(straightQuote + straightQuote)
  ) {
    normalized = normalized.slice(1, -1);
  }

  return normalized;
};

// Filter out articles without turabian-citation and sort alphabetically by citation
const sortedArticles = [...articles]
  .filter((article) => article["turabian-citation"] && article["turabian-citation"].trim())
  .map((article) => ({
    ...article,
    "turabian-citation": normalizeCitation(article["turabian-citation"] || "")
  }))
  .filter((article) => article["turabian-citation"]) // Filter again after normalization
  .sort((a, b) => {
    const citationA = (a["turabian-citation"] || "").toLowerCase();
    const citationB = (b["turabian-citation"] || "").toLowerCase();
    return citationA.localeCompare(citationB);
  });
---

<PageLayout title="Sources" currentPage="sources">
  <div class="container-standard">
    <h1 class="text-4xl font-bold mb-6">Sources</h1>
  
  <p class="mb-8 text-lg max-w-4xl leading-relaxed">
    The items in this bibliography were used and consulted in the creation of much of the content on this website. Further Readings lists scholarly and secondary works; Primary Sources lists digitized newspaper articles. Together they provide the foundation for understanding the historical context, events, and scholarly interpretations that inform our digital archive of anti-Chinese violence in the American West during the second half of the 19th century.
  </p>

  <h2 class="text-2xl font-semibold mb-4 mt-8">Further Readings</h2>
  <div class="space-y-3 mb-8">
    <p>Ambrose, Stephen E. <em>Nothing Like It in the World: The Men Who Built the Transcontinental Railroad, 1863–1869.</em> Simon & Schuster, 2000.</p>
    <p>Bailey, Amy Kate, and Stewart E. Tolnay. "CSDE Lynching Database." Accessed February 8, 2019. http://lynching.csde.washington.edu/#/home.</p>
    <p>———. <em>Lynched: The Victims of Southern Mob Violence.</em> Chapel Hill: University of North Carolina Press, 2015.</p>
    <p>Berg, Manfred. <em>Popular Justice: A History of Lynching in America.</em> Rowman & Littlefield, 2011.</p>
    <p>Brundage, W. Fitzhugh. <em>Lynching in the New South: Georgia and Virginia, 1880–1930.</em> Urbana: University of Illinois Press, 1993.</p>
    <p>Brundage, W. Fitzhugh, ed. <em>Under Sentence of Death: Lynching in the South.</em> Chapel Hill: University of North Carolina Press, 1997.</p>
    <p>Carrigan, William, and Clive Webb. "The Lynching of Persons of Mexican Origin in the United States, 1848–1928." <em>Journal of Social History</em> 37, no. 2 (2003): 411–438.</p>
    <p>Chang, Gordon H. <em>Ghosts of Gold Mountain: The Epic Story of the Chinese Who Built the Transcontinental Railroad.</em> Houghton Mifflin Harcourt, 2019.</p>
    <p>Daniels, Roger. <em>Asian America: Chinese and Japanese in the United States since 1850.</em> Seattle: University of Washington Press, 1988.</p>
    <p>Gonzales-Day, Ken. <em>Lynching in the West: 1850–1935.</em> Durham: Duke University Press, 2006.</p>
    <p>Gyory, Andrew. <em>Closing the Gate: Race, Politics, and the Chinese Exclusion Act.</em> Chapel Hill: University of North Carolina Press, 1998.</p>
    <p>Kanazawa, Mark. "Immigration, Exclusion, and Taxation: Anti-Chinese Legislation in Gold Rush California." <em>The Journal of Economic History</em> 65, no. 3 (2005): 779–805.</p>
    <p>Lee, Erika. <em>At America's Gates: Chinese Immigration during the Exclusion Era, 1882–1943.</em> Chapel Hill: University of North Carolina Press, 2003.</p>
    <p>Lee, Erika, and Judy Yung. <em>Angel Island: Immigrant Gateway to America.</em> New York: Oxford University Press, 2010.</p>
    <p>Lee, Robert G. <em>Orientals: Asian Americans in Popular Culture.</em> Philadelphia: Temple University Press, 1999.</p>
    <p>Leonard, Stephen J. <em>Lynching in Colorado, 1859–1919.</em> Boulder: University Press of Colorado, 2002.</p>
    <p>Lew-Williams, Beth. <em>The Chinese Must Go: Violence, Exclusion, and the Making of the Alien in America.</em> Cambridge, MA: Harvard University Press, 2018.</p>
    <p>Mason, Nicholas W. "Anti-Chinese Violence in the United States, 1850–1910." PhD diss., Syracuse University, 2024.</p>
    <p>McClain, Charles J. <em>In Search of Equality: The Chinese Struggle Against Discrimination in Nineteenth-Century America.</em> Berkeley: University of California Press, 1994.</p>
    <p>Monroe &amp; Florence Work Today. "Explore the Map of Mob Violence." 2021. https://plaintalkhistory.com/monroeandflorencework/explore/.</p>
    <p>Nokes, R. Gregory. <em>Massacred for Gold: The Chinese in Hells Canyon.</em> Corvallis: Oregon State University Press, 2009.</p>
    <p>Pfaelzer, Jean. <em>Driven Out: The Forgotten War Against Chinese Americans.</em> New York: Random House, 2007.</p>
    <p>Pfeifer, Michael J. <em>Rough Justice: Lynching and American Society, 1874–1947.</em> Urbana: University of Illinois Press, 2004.</p>
    <p>Pfeifer, Michael J., ed. <em>Lynching Beyond Dixie: American Mob Violence Outside the South.</em> Urbana: University of Illinois Press, 2013.</p>
    <p>Salyer, Lucy E. <em>Laws Harsh as Tigers: Chinese Immigrants and the Shaping of Modern Immigration Law.</em> Chapel Hill: University of North Carolina Press, 1995.</p>
    <p>Sandmeyer, Elmer Clarence. <em>The Anti-Chinese Movement in California.</em> Urbana: University of Illinois Press, 1991.</p>
    <p>Saxton, Alexander. <em>The Indispensable Enemy: Labor and the Anti-Chinese Movement in California.</em> Berkeley: University of California Press, 1971.</p>
    <p>Tchen, John Kuo Wei. <em>New York Before Chinatown: Orientalism and the Shaping of American Culture, 1776–1882.</em> Baltimore: Johns Hopkins University Press, 1999.</p>
    <p>Tolnay, Stewart E., and E. M. Beck. <em>A Festival of Violence: An Analysis of Southern Lynchings, 1882–1930.</em> Urbana: University of Illinois Press, 1995.</p>
    <p>———. "'Racialized Terrorism' in the American South: Do Completed Lynchings Tell an Accurate Story?" <em>Social Science History</em> 42, no. 4 (2018): 677–701.</p>
    <p>Waldrep, Christopher. <em>The Many Faces of Judge Lynch: Extralegal Violence and Punishment in America.</em> New York: Palgrave, 2002.</p>
    <p>———. "War of Words: The Controversy over the Definition of Lynching, 1899–1940." <em>The Journal of Southern History</em> 66, no. 1 (2000): 75–100.</p>
    <p>Zesch, Scott. <em>The Chinatown War: Chinese Los Angeles and the Massacre of 1871.</em> New York: Oxford University Press, 2012.</p>
    <p>Zhu, Liping. <em>A Chinaman's Chance: The Chinese on the Rocky Mountain Mining Frontier.</em> Niwot, CO: University Press of Colorado, 1997.</p>
    <p>———. <em>The Road to Chinese Exclusion: The Denver Riot, 1880 Election, and Rise of the West.</em> Lawrence: University Press of Kansas, 2013.</p>
  </div>

  <h2 class="text-2xl font-semibold mb-4 mt-8">Primary Sources</h2>
  <div class="space-y-3 mb-8">
    {sortedArticles.map((article) => {
      const citation = article["turabian-citation"] || "";
      const clipUrl = article["clip_url"] || "";
      const articleId = article["article-id"] || "";
      
      return (
        <p>
          {citation}
          {clipUrl && (
            <>
              {" "}
              Accessed <a href={clipUrl} class="underline" target="_blank" rel="noopener noreferrer">via newspaper archive</a>.
            </>
          )}
          {articleId && (
            <>
              {" "}
              <a href={`/articles/${articleId}`} class="underline text-gray-500">(view full article)</a>
            </>
          )}
        </p>
      );
    })}
  </div>
  </div>
</PageLayout> 